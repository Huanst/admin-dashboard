const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Login-DBljeki1.js","assets/element-plus-wIhg9Y3M.js","assets/vendor-CXaOXOXP.js","assets/vendor-BgDCIyLK.css","assets/element-plus-BSEncwNA.css","assets/Login-soF9mD64.css","assets/index-DEhryLqR.js","assets/index-BDsx7i41.css","assets/Dashboard-vVZBt93k.js","assets/echarts-DUZPau0P.js","assets/index-zFB-kJVX.js","assets/Dashboard-SDpczIji.css","assets/index-C0HWH-Gi.js","assets/api-D78is_CB.js","assets/index-BbFoOxHz.css","assets/TestAPI-wYBGKeT1.js","assets/TestAPI-BMK-cAPx.css","assets/Detail-DVNu_tAQ.js","assets/Detail-DV70jlem.css","assets/index-caQ8f_RT.js","assets/index-DfFRWt7D.css","assets/index-DhfZAphN.js","assets/index-B6SKEU9v.css","assets/index-ClWysdu1.js","assets/index-5JcdLYFP.css","assets/404-B88_244z.js","assets/404-DNMKecqa.css"])))=>i.map(i=>d[i]);
import{dN as A,dO as N,dP as j,dQ as C,dR as R,bu as _,bv as B,cy as v,bL as U,bQ as V,bT as I,c6 as T,bU as P,cb as b,c4 as E,bV as w,c9 as $,c8 as L,db as x,dK as z,dS as F}from"./vendor-CXaOXOXP.js";import{E as a,a as M,b as H,c as J,i as K,z as Q}from"./element-plus-wIhg9Y3M.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const n of r)if(n.type==="childList")for(const l of n.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&i(l)}).observe(document,{childList:!0,subtree:!0});function e(r){const n={};return r.integrity&&(n.integrity=r.integrity),r.referrerPolicy&&(n.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?n.credentials="include":r.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(r){if(r.ep)return;r.ep=!0;const n=e(r);fetch(r.href,n)}})();const W="modulepreload",G=function(t){return"/"+t},O={},h=function(s,e,i){let r=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));r=Promise.allSettled(e.map(m=>{if(m=G(m),m in O)return;O[m]=!0;const o=m.endsWith(".css"),u=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${u}`))return;const d=document.createElement("link");if(d.rel=o?"stylesheet":W,o||(d.as="script"),d.crossOrigin="",d.href=m,c&&d.setAttribute("nonce",c),document.head.appendChild(d),o)return new Promise((p,q)=>{d.addEventListener("load",p),d.addEventListener("error",()=>q(new Error(`Unable to preload CSS for ${m}`)))})}))}function n(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return r.then(l=>{for(const c of l||[])c.status==="rejected"&&n(c.reason);return s().catch(n)})};A.configure({showSpinner:!1});const X=[{path:"/login",name:"Login",component:()=>h(()=>import("./Login-DBljeki1.js"),__vite__mapDeps([0,1,2,3,4,5])),meta:{title:"登录",requiresAuth:!1}},{path:"/",name:"Layout",component:()=>h(()=>import("./index-DEhryLqR.js"),__vite__mapDeps([6,2,3,1,4,7])),redirect:"/dashboard",meta:{requiresAuth:!0},children:[{path:"/dashboard",name:"Dashboard",component:()=>h(()=>import("./Dashboard-vVZBt93k.js"),__vite__mapDeps([8,1,2,3,4,9,10,11])),meta:{title:"仪表盘",icon:"DataBoard"}},{path:"/users",name:"Users",component:()=>h(()=>import("./index-C0HWH-Gi.js"),__vite__mapDeps([12,1,2,3,4,13,10,14])),meta:{title:"用户管理",icon:"User"}},{path:"/test-api",name:"TestAPI",component:()=>h(()=>import("./TestAPI-wYBGKeT1.js"),__vite__mapDeps([15,1,2,3,4,13,16])),meta:{title:"API测试",icon:"Setting"}},{path:"/users/:id",name:"UserDetail",component:()=>h(()=>import("./Detail-DVNu_tAQ.js"),__vite__mapDeps([17,1,2,3,4,13,10,18])),meta:{title:"用户详情",icon:"User"}},{path:"/images",name:"Images",component:()=>h(()=>import("./index-caQ8f_RT.js"),__vite__mapDeps([19,1,2,3,4,13,10,20])),meta:{title:"图片管理",icon:"Picture"}},{path:"/generate",name:"Generate",component:()=>h(()=>import("./index-DhfZAphN.js"),__vite__mapDeps([21,1,2,3,4,10,22])),meta:{title:"AI图片生成",icon:"PictureFilled"}},{path:"/system",name:"System",component:()=>h(()=>import("./index-ClWysdu1.js"),__vite__mapDeps([23,1,2,3,4,13,24])),meta:{title:"系统设置",icon:"Setting"}}]},{path:"/:pathMatch(.*)*",name:"NotFound",component:()=>h(()=>import("./404-B88_244z.js"),__vite__mapDeps([25,1,2,3,4,26])),meta:{title:"页面不存在"}}],k=N({history:j(),routes:X});k.beforeEach(async(t,s,e)=>{A.start();const i=g();if(t.meta.title&&(document.title=`${t.meta.title} - 后台管理系统`),t.meta.requiresAuth!==!1&&!i.isLoggedIn&&!await i.restoreFromStorage()){e("/login");return}if(t.path==="/login"&&i.isLoggedIn){e("/");return}e()});k.afterEach(()=>{A.done()});const f=C.create({baseURL:"http://localhost:5004/api",timeout:1e4,headers:{"Content-Type":"application/json"}});f.interceptors.request.use(t=>{const s=g();return s.token&&(t.headers=t.headers||{},t.headers.Authorization=`Bearer ${s.token}`),t},t=>(console.error("请求错误:",t),Promise.reject(t)));f.interceptors.response.use(t=>{const{data:s}=t;return s},t=>{if(console.error("响应错误:",t),t.response){const{status:s,data:e}=t.response;switch(s){case 400:a.error((e==null?void 0:e.message)||"请求参数错误");break;case 401:g().logout(),k.push("/login"),a.error((e==null?void 0:e.message)||"未授权，请重新登录");break;case 403:a.error((e==null?void 0:e.message)||"权限不足");break;case 404:a.error((e==null?void 0:e.message)||"资源不存在");break;case 409:a.error((e==null?void 0:e.message)||"资源冲突");break;case 413:a.error((e==null?void 0:e.message)||"文件过大");break;case 415:a.error((e==null?void 0:e.message)||"不支持的文件类型");break;case 500:a.error((e==null?void 0:e.message)||"服务器内部错误");break;default:a.error((e==null?void 0:e.message)||"请求失败")}}else t.request?a.error("网络连接失败，请检查网络设置"):a.error("请求配置错误");return Promise.reject(t)});const S=C.create({baseURL:"http://localhost:5004",timeout:1e4,headers:{"Content-Type":"application/json"}});S.interceptors.request.use(t=>{const s=g();return s.token&&(t.headers=t.headers||{},t.headers.Authorization=`Bearer ${s.token}`),t},t=>(console.error("管理员请求错误:",t),Promise.reject(t)));S.interceptors.response.use(t=>{const{data:s}=t;return s},t=>{if(console.error("管理员响应错误:",t),t.response){const{status:s,data:e}=t.response;switch(s){case 400:a.error((e==null?void 0:e.message)||"请求参数错误");break;case 401:g().logout(),k.push("/login"),a.error((e==null?void 0:e.message)||"未授权，请重新登录");break;case 403:a.error((e==null?void 0:e.message)||"权限不足");break;case 404:a.error((e==null?void 0:e.message)||"资源不存在");break;case 409:a.error((e==null?void 0:e.message)||"资源冲突");break;case 413:a.error((e==null?void 0:e.message)||"文件过大");break;case 415:a.error((e==null?void 0:e.message)||"不支持的文件类型");break;case 500:a.error((e==null?void 0:e.message)||"服务器内部错误");break;default:a.error((e==null?void 0:e.message)||"请求失败")}}else t.request?a.error("网络连接失败，请检查网络设置"):a.error("请求配置错误");return Promise.reject(t)});const D={register(t){return f.post("/auth/register",t)},login(t){return S.post("/auth/login",t)},getUserInfo(){return f.get("/user/profile")},validateToken(){return S.post("/auth/validate-token")}},g=R("auth",()=>{const t=_(null),s=_(null),e=_(!1),i=B(()=>!!t.value&&!!s.value),r=async m=>{e.value=!0;try{const o=await D.login(m);if(o.success&&o.data){const{token:u,...d}=o.data;return t.value=u,s.value=d,localStorage.setItem("admin_token",u),localStorage.setItem("admin_user",JSON.stringify(d)),a.success(o.message||"登录成功"),{success:!0,data:d}}else throw new Error(o.message||"登录失败")}catch(o){let u="登录失败，请重试";if(o.response){const{status:d,data:p}=o.response;switch(d){case 400:u=(p==null?void 0:p.message)||"请求参数错误";break;case 401:u=(p==null?void 0:p.message)||"用户名或密码错误";break;case 404:u=(p==null?void 0:p.message)||"用户不存在";break;case 500:u=(p==null?void 0:p.message)||"服务器内部错误";break;default:u=(p==null?void 0:p.message)||u}}else o.request&&(u="无法连接到服务器");return a.error(u),{success:!1,error:u}}finally{e.value=!1}},n=()=>{t.value=null,s.value=null,localStorage.removeItem("admin_token"),localStorage.removeItem("admin_user"),a.info("已退出登录")},l=async()=>{const m=localStorage.getItem("admin_token"),o=localStorage.getItem("admin_user");if(m&&o)try{return t.value=m,s.value=JSON.parse(o),!!await c()}catch{return n(),!1}return!1},c=async()=>{var m;try{const o=await D.getUserInfo();if(o.success&&o.data)return s.value=o.data,localStorage.setItem("admin_user",JSON.stringify(o.data)),o.data}catch(o){console.error("获取用户信息失败:",o),((m=o.response)==null?void 0:m.status)===401&&n()}return null};return{token:v(t),user:v(s),loading:v(e),isLoggedIn:i,login:r,logout:n,restoreFromStorage:l,getUserInfo:c}}),Y=R("theme",()=>{const t=_(!1),s=_(!1),e=()=>{t.value=!t.value,i(),localStorage.setItem("admin_theme",t.value?"dark":"light")},i=()=>{const c=document.documentElement;t.value?c.classList.add("dark"):c.classList.remove("dark")},r=()=>{const c=localStorage.getItem("admin_theme"),m=window.matchMedia("(prefers-color-scheme: dark)").matches;c?t.value=c==="dark":t.value=m,i(),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",o=>{localStorage.getItem("admin_theme")||(t.value=o.matches,i())})},n=()=>{s.value=!s.value,localStorage.setItem("admin_sidebar_collapsed",String(s.value))},l=()=>{const c=localStorage.getItem("admin_sidebar_collapsed");c!==null&&(s.value=c==="true")};return{isDark:v(t),sidebarCollapsed:v(s),toggleTheme:e,toggleSidebar:n,initTheme:r,initSidebar:l}}),Z={checkHealth(){return f.get("/health")},getTestUsers(){return f.get("/api/test-users")},createTestUsers(){return f.post("/api/create-test-users")}},ee={key:0,class:"api-status"},te={class:"status-content"},se={key:0,class:"status-actions"},re=U({__name:"ApiStatus",setup(t){const s=_(!1),e=_(!1),i=_(""),r=_(""),n=_("info"),l=async()=>{try{await Z.checkHealth(),e.value=!0,i.value="API连接正常",r.value="后端服务运行正常，所有功能可用。",n.value="success",s.value=!0,setTimeout(()=>{s.value=!1},3e3)}catch{e.value=!1,i.value="后端服务未启动",r.value="检测到后端API服务未启动，当前显示的是模拟数据。请启动后端服务以获取真实数据。",n.value="warning",s.value=!0}},c=()=>{a({message:"请确保后端服务在 http://localhost:5004 端口运行",type:"info",duration:5e3})},m=()=>{s.value=!1};return V(()=>{setTimeout(l,1e3)}),(o,u)=>{const d=H,p=M;return s.value?(P(),I("div",ee,[b(p,{title:i.value,type:n.value,closable:!0,onClose:m,"show-icon":""},{default:E(()=>[w("div",te,[w("p",null,$(r.value),1),e.value?T("",!0):(P(),I("div",se,[b(d,{size:"small",onClick:l},{default:E(()=>u[0]||(u[0]=[L("重新检测")])),_:1,__:[0]}),b(d,{size:"small",type:"primary",onClick:c},{default:E(()=>u[1]||(u[1]=[L("查看帮助")])),_:1,__:[1]})]))])]),_:1},8,["title","type"])])):T("",!0)}}}),oe=(t,s)=>{const e=t.__vccOpts||t;for(const[i,r]of s)e[i]=r;return e},ne=oe(re,[["__scopeId","data-v-b5ed8576"]]),ae={id:"app"},ce=U({__name:"App",setup(t){const s=g(),e=Y();return V(async()=>{e.initTheme(),await s.restoreFromStorage()}),(i,r)=>{const n=x("router-view");return P(),I("div",ae,[b(n),b(ne)])}}}),y=z(ce);for(const[t,s]of Object.entries(J))y.component(t,s);y.use(F());y.use(k);y.use(K,{locale:Q});y.mount("#app");export{oe as _,Y as a,S as b,f as r,g as u};
