import{H as Y,b as Z,I as j,g as K,u as W,B as ee,J as te}from"./element-plus-wIhg9Y3M.js";import{i as G}from"./echarts-DUZPau0P.js";import{b as v,r as h,a as se,_ as ae}from"./index-BLw7aUal.js";import{f as oe}from"./index-zFB-kJVX.js";import{bL as re,bu as d,bP as ne,bQ as le,bZ as f,cg as ie,bT as _,bV as s,ca as I,cD as S,cb as r,c4 as n,V as R,c8 as c,bU as u,c9 as p,bY as de,c3 as O,c7 as M,bX as ce,bw as N}from"./vendor-CXaOXOXP.js";const ue={getUsers(o={}){return v.get("/admin/users",{params:o})},getUserById(o){return v.get(`/admin/users/${o}`)},getUserDetail(o){return this.getUserById(o)},createUser(o){return v.post("/admin/users",o)},updateUser(o,b){return v.put(`/admin/users/${o}`,b)},deleteUser(o){return v.delete(`/admin/users/${o}`)},batchDeleteUsers(o){return v.post("/admin/users/batch-delete",{userIds:o})}},y={getStats(){return h.get("/dashboard/stats")},getUserGrowthTrend(o=7){return h.get("/dashboard/user-growth-trend",{params:{days:o}})},getImageGenerationTrend(o=7){return h.get("/dashboard/image-generation-trend",{params:{days:o}})},getPopularPrompts(o=5){return h.get("/dashboard/popular-prompts",{params:{limit:o}})}},pe={class:"dashboard"},_e={class:"stats-grid"},me={class:"stat-content"},ve={class:"stat-info"},ge={class:"stat-title"},fe={class:"stat-value"},he={class:"charts-grid"},ye={class:"chart-card"},be={class:"chart-header"},Te={class:"chart-content"},we={class:"chart-card"},Ue={class:"chart-header"},ke={class:"chart-content"},xe={class:"bottom-grid"},Pe={class:"info-card"},De={class:"card-header"},Ie={class:"card-content"},Se={class:"prompt-list"},ze={class:"prompt-text"},Ve={class:"prompt-count"},Be={class:"info-card"},Ae={class:"card-header"},Ee={class:"card-content"},Ce={class:"user-list"},Le={class:"user-info"},Ge={class:"user-name"},Re={class:"user-time"},Oe=re({__name:"Dashboard",setup(o){const b=se(),T=d(),w=d();let l=null,i=null;const z=d("7d"),V=d("7d"),g=d([{key:"totalUsers",title:"总用户数",value:"0",change:"+0%",changeType:"increase",icon:"User",color:"#409eff"},{key:"totalImages",title:"总图片数",value:"0",change:"+0%",changeType:"increase",icon:"Picture",color:"#67c23a"},{key:"todayImages",title:"今日生成",value:"0",change:"+0%",changeType:"increase",icon:"TrendCharts",color:"#e6a23c"},{key:"activeUsers",title:"活跃用户",value:"0",change:"+0%",changeType:"increase",icon:"DataAnalysis",color:"#f56c6c"}]),B=d([]),A=d([]),U=d([]),k=()=>{if(!T.value){console.warn("用户趋势图表DOM元素未准备好");return}try{l&&(l.dispose(),l=null),l=G(T.value);const t={tooltip:{trigger:"axis",axisPointer:{type:"cross"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:U.value.map(e=>e.date)||["暂无数据"]},yAxis:{type:"value"},series:[{name:"新增用户",type:"line",smooth:!0,data:U.value.map(e=>e.count)||[0],itemStyle:{color:"#409eff"},areaStyle:{color:new R(0,0,0,1,[{offset:0,color:"rgba(64, 158, 255, 0.3)"},{offset:1,color:"rgba(64, 158, 255, 0.1)"}])}}]};l.setOption(t)}catch(t){console.error("用户趋势图表初始化失败:",t)}},x=d([]),P=()=>{if(!w.value){console.warn("图片趋势图表DOM元素未准备好");return}try{i&&(i.dispose(),i=null),i=G(w.value);const t={tooltip:{trigger:"axis",axisPointer:{type:"cross"}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:x.value.map(e=>e.date)||["暂无数据"]},yAxis:{type:"value"},series:[{name:"图片生成",type:"bar",data:x.value.map(e=>e.count)||[0],itemStyle:{color:new R(0,0,0,1,[{offset:0,color:"#67c23a"},{offset:1,color:"#85ce61"}])}}]};i.setOption(t)}catch(t){console.error("图片趋势图表初始化失败:",t)}},$=async()=>{try{const t=await y.getStats();if(t.success&&t.data){const e=t.data;g.value[0].value=e.totalUsers.toString(),g.value[1].value=e.totalImages.toString(),g.value[2].value=e.todayImages.toString(),g.value[3].value=e.activeUsers.toString()}}catch(t){console.warn("统计数据加载失败，使用默认数据:",t)}},q=async()=>{try{const t=await y.getUserGrowthTrend(7);t.success&&t.data&&(U.value=t.data,f(()=>{k()}))}catch(t){console.warn("用户趋势数据加载失败，使用模拟数据:",t)}},F=async()=>{try{const t=await y.getImageGenerationTrend(7);t.success&&t.data&&(x.value=t.data,f(()=>{P()}))}catch(t){console.warn("图片趋势数据加载失败，使用模拟数据:",t)}},H=async()=>{try{const t=await y.getPopularPrompts(5);t.success&&t.data&&(B.value=t.data)}catch(t){console.warn("热门提示词加载失败，使用模拟数据:",t)}},J=async()=>{try{const t=await ue.getUsers({page:1,pageSize:5});t.success&&t.data&&t.data.list&&(A.value=t.data.list.map(e=>({...e,status:"active"})))}catch(t){console.warn("最新用户加载失败，使用模拟数据:",t)}};ne(()=>b.isDark,()=>{f(()=>{l&&(l.dispose(),k()),i&&(i.dispose(),P())})});const E=()=>{l==null||l.resize(),i==null||i.resize()};return le(async()=>{try{await f(),await Promise.all([$(),q(),F(),H(),J()]),await f(),setTimeout(()=>{k(),P()},100),window.addEventListener("resize",E)}catch(t){console.error("Dashboard初始化失败:",t)}}),ie(()=>{l==null||l.dispose(),i==null||i.dispose(),window.removeEventListener("resize",E)}),(t,e)=>{const D=K,m=j,C=Y,L=Z,Q=ee,X=te;return u(),_("div",pe,[s("div",_e,[(u(!0),_(I,null,S(g.value,a=>(u(),_("div",{class:"stat-card",key:a.key},[s("div",me,[s("div",ve,[s("h3",ge,p(a.title),1),s("div",fe,p(a.value),1),s("div",{class:de(["stat-change",a.changeType])},[r(D,null,{default:n(()=>[(u(),O(M(a.changeType==="increase"?"TrendCharts":"Bottom")))]),_:2},1024),s("span",null,p(a.change),1)],2)]),s("div",{class:"stat-icon",style:ce({backgroundColor:a.color})},[r(D,{size:24},{default:n(()=>[(u(),O(M(a.icon)))]),_:2},1024)],4)])]))),128))]),s("div",he,[s("div",ye,[s("div",be,[e[5]||(e[5]=s("h3",null,"用户增长趋势",-1)),r(C,{modelValue:z.value,"onUpdate:modelValue":e[0]||(e[0]=a=>z.value=a),size:"small"},{default:n(()=>[r(m,{value:"7d"},{default:n(()=>e[2]||(e[2]=[c("7天")])),_:1,__:[2]}),r(m,{value:"30d"},{default:n(()=>e[3]||(e[3]=[c("30天")])),_:1,__:[3]}),r(m,{value:"90d"},{default:n(()=>e[4]||(e[4]=[c("90天")])),_:1,__:[4]})]),_:1},8,["modelValue"])]),s("div",Te,[s("div",{ref_key:"userTrendChart",ref:T,class:"chart"},null,512)])]),s("div",we,[s("div",Ue,[e[9]||(e[9]=s("h3",null,"图片生成趋势",-1)),r(C,{modelValue:V.value,"onUpdate:modelValue":e[1]||(e[1]=a=>V.value=a),size:"small"},{default:n(()=>[r(m,{value:"7d"},{default:n(()=>e[6]||(e[6]=[c("7天")])),_:1,__:[6]}),r(m,{value:"30d"},{default:n(()=>e[7]||(e[7]=[c("30天")])),_:1,__:[7]}),r(m,{value:"90d"},{default:n(()=>e[8]||(e[8]=[c("90天")])),_:1,__:[8]})]),_:1},8,["modelValue"])]),s("div",ke,[s("div",{ref_key:"imageTrendChart",ref:w,class:"chart"},null,512)])])]),s("div",xe,[s("div",Pe,[s("div",De,[e[11]||(e[11]=s("h3",null,"热门提示词",-1)),r(L,{type:"primary",link:""},{default:n(()=>e[10]||(e[10]=[c("查看更多")])),_:1,__:[10]})]),s("div",Ie,[s("div",Se,[(u(!0),_(I,null,S(B.value,a=>(u(),_("div",{key:a.id,class:"prompt-item"},[s("div",ze,p(a.text),1),s("div",Ve,p(a.count)+"次",1)]))),128))])])]),s("div",Be,[s("div",Ae,[e[13]||(e[13]=s("h3",null,"最新用户",-1)),r(L,{type:"primary",link:""},{default:n(()=>e[12]||(e[12]=[c("查看更多")])),_:1,__:[12]})]),s("div",Ee,[s("div",Ce,[(u(!0),_(I,null,S(A.value,a=>(u(),_("div",{key:a.id,class:"user-item"},[r(Q,{size:32,src:a.avatar},{default:n(()=>[r(D,null,{default:n(()=>[r(N(W))]),_:1})]),_:2},1032,["src"]),s("div",Le,[s("div",Ge,p(a.username),1),s("div",Re,p(N(oe)(a.createdAt)),1)]),r(X,{type:a.status==="active"?"success":"info",size:"small"},{default:n(()=>[c(p(a.status==="active"?"活跃":"新用户"),1)]),_:2},1032,["type"])]))),128))])])])])])}}}),Je=ae(Oe,[["__scopeId","data-v-076d074a"]]);export{Je as default};
